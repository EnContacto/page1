<html>
<head>
<title>Informe de D:\</title>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<style>
body{
    font-family:'Segoe UI',Arial;margin:0;
    background:#eef1f5;color:#333;
    transition:0.3s;
}

body.dark{
    background:#1e1e1e;
    color:#e0e0e0;
}

header{
    background:#2c3e50;color:white;padding:25px;text-align:center
}

body.dark header{
    background:#111;
}

.card{
    background:white;padding:25px;margin-bottom:30px;border-radius:12px;
    box-shadow:0 4px 12px rgba(0,0,0,0.1);transition:0.3s;
}

body.dark .card{
    background:#2b2b2b;
    color:white;
    box-shadow:0 4px 12px rgba(255,255,255,0.05);
}

table{width:100%;border-collapse:collapse;margin-top:15px}
th{
    background:#34495e;color:white;padding:8px
}
body.dark th{
    background:#000;
}

td{
    background:white;padding:8px;border-bottom:1px solid #ddd
}
body.dark td{
    background:#3a3a3a;border-bottom:1px solid #555;
}

.summary-box{
    background:#34495e;color:white;padding:20px;border-radius:10px;font-size:18px
}
body.dark .summary-box{
    background:#000;
}

.theme-btn{
    position:fixed;top:15px;right:15px;
    padding:10px 18px;font-size:15px;
    border:none;border-radius:8px;
    background:#3498db;color:white;
    cursor:pointer;transition:0.3s;
}
</style>
</head>
<body>

<button class="theme-btn" onclick="toggleTheme()">üåô/‚òÄÔ∏è Tema</button>

<header>
<h1>Informe-An√°lisis: TOSHIBA-EXT</h1>
</header>

<section>
<div class='card'>
<h2>Resumen General</h2>
<div id="resumen" class='summary-grid'>
<!-- Se llenar√° con JSON -->
</div>
</div>

<div class='card'>
<h2>Uso del disco</h2>
<canvas id='chartEspacio'></canvas>
</div>

<div class='card'>
<h2>Distribuci√≥n de archivos por a√±o</h2>
<canvas id='chartAnios'></canvas>
</div>

<div class='card'>
<h2>Top 10 carpetas m√°s pesadas</h2>
<table id="tablaTop">
<tr><th>Carpeta</th><th>TotalMB</th></tr>
</table>
</div>

<div class='card'>
<h2>Archivos grandes (>100MB)</h2>
<table id="tablaGrandes">
<tr><th>Ruta Archivo</th><th>Nivel</th><th>Tama√±oMB</th><th>Creado</th><th>A√±o</th><th>Carpeta</th><th>Ext</th></tr>
</table>
</div>

<div class='card'>
<h2>Archivos antiguos (>8 a√±os)</h2>
<table id="tablaAntiguos">
<tr><th>Ruta Archivo</th><th>Nivel</th><th>Tama√±oMB</th><th>Creado</th><th>A√±o</th><th>Carpeta</th><th>Ext</th></tr>
</table>
</div>

</section>

<script>
// ==========================
// üåô CAMBIO DE TEMA
// ==========================
function toggleTheme(){
    document.body.classList.toggle("dark");
    localStorage.setItem("modo", document.body.classList.contains("dark") ? "oscuro" : "claro");
}

// Mantener preferencia
if(localStorage.getItem("modo")==="oscuro"){
    document.body.classList.add("dark");
}

// ==========================
// üì• CARGAR JSON GENERADO DESDE POWERSHELL
// ==========================
fetch("data.json") // <<--- TU JSON DE POWERSHELL
    .then(r => r.json())
    .then(data => {
        cargarResumen(data.resumen);
        cargarTabla("tablaTop", data.top10);
        cargarTabla("tablaGrandes", data.archivosGrandes);
        cargarTabla("tablaAntiguos", data.archivosAntiguos);
        crearGraficos(data);
    });

// ==========================
// üü¶ CARGAR RESUMEN
// ==========================
function cargarResumen(r){
    document.getElementById("resumen").innerHTML = `
        <div class='summary-box'>Archivos analizados<br><b>${r.archivos}</b></div>
        <div class='summary-box'>Espacio usado<br><b>${r.usado} GB</b></div>
        <div class='summary-box'>Espacio libre<br><b>${r.libre} GB</b></div>
        <div class='summary-box'>Estado disco<br><b>${r.estado}</b></div>
    `;
}

// ==========================
// üü© CARGAR TABLAS
// ==========================
function cargarTabla(id, filas){
    let t = document.getElementById(id);
    filas.forEach(f => {
        let tr = "<tr>";
        for(let v of Object.values(f)){
            tr += `<td>${v}</td>`;
        }
        tr += "</tr>";
        t.innerHTML += tr;
    });
}

// ==========================
// üìä GRAFICOS CHART.JS
// ==========================
function crearGraficos(data){

    // Uso del disco
    new Chart(document.getElementById("chartEspacio"), {
        type: "pie",
        data: {
            labels: ["Usado", "Libre"],
            datasets: [{
                data: [data.resumen.usado, data.resumen.libre]
            }]
        }
    });

    // Archivos por a√±o
    new Chart(document.getElementById("chartAnios"), {
        type: "bar",
        data: {
            labels: data.anios.labels,
            datasets: [{
                label: "Cantidad",
                data: data.anios.valores
            }]
        }
    });
}
</script>
</body>
</html>
